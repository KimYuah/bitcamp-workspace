### 1. 채팅 데이터베이스에 필요한 사항들을 정리

- 사원이 채팅 페이지에 접속한다.
- 사원은 채팅 페이지에서 사원 프로필과 개인, 그룹메시지, 직원검색, 초대멤버를 볼 수 있다.
- 사원은 개인, 그룹메시지 목록의 채팅방 중 하나를 선택해서 채팅을 할 수 있다.
   [메뉴]
    - 사원프로필 : 사원사진, 이름, 온오프상태, 소속부서, 직급
                   사원프로필에서는 온오프상태를 변경할 수 있다.
    - 개인메시지 : 채팅상대정보(사원사진,이름,소속부서,직급,온오프상태)와 
                    새로온메시지갯수알림을 볼 수 있고 채팅 상대를 추가할 수 있는 기능이 있다.
    - 그룹메시지 : 채팅그룹정보(채팅명)와 새로온메시지갯수알림을 볼 수 있고, 
                    새로운 채팅그룹대화방을 만들 수 있는 기능이 있다.
- 사원은 사원 검색에서 사원을 검색한다.
- 검색한 사원을 초대 멤버에 추가한다.
- 추가한 멤버들과 채팅방을 만든다.
   [바디]
    - 직원검색 : 회사 전직원의 사원사진, 사원이름, 소속부서, 사원직급의 목록을 볼 수 있고
                 이름, 소속부서, 직급으로 검색하고 체크박스를 사용하여 
                 원하는 사원을 선택해서 채팅 초대할 수 있다.
    - 초대멤버 : 직원 검색에서 채팅 초대 한 멤버의 목록을 보여준다.
                채팅 초대된 멤버를 삭제할 수도 있다.
    - 새 대화방 만들기 : 선택된 멤버들로 새 대화방을 만들 수 있다.
- 채팅방 안에서 채팅을 할 수 있다.
- 사원은 채팅 중 방상세정보로 들어가서 방상세정보를 확인할 수 있고, 채팅방 관리를 할 수 있다.
  [채팅방]
      - 개인메시지 : 채팅상대이름, 채팅작성시간, 받은채팅내용, 보내는채팅내용,
                    채팅상태정보(어디까지읽었는지,대화날짜), 링크, 파일, 방상세정보
      - 그룹메시지 : 채팅방명, 채팅방설명, 받은채팅내용, 보내는채팅내용, 채팅인원,
                    채팅상태정보(어디까지읽었는지, 대화날짜), 링크, 파일, 방상세정보
        * 방상세정보 
           - 대화상대목록, 대화상대초대,
            사진 및 동영상(사진갯수,사진/동영상 용량, 올린날짜)
            /파일(파일갯수,파일용량,올린날짜)/링크 관리(목록,공유,삭제 기능)


### 2.위 내용을 요구사항과 엔티티로 구분한다.

**요구 사항**
- 사원이 채팅 페이지에 접속한다.
- 사원은 채팅 페이지에서 사원 프로필과 개인, 그룹메시지, 직원검색, 초대멤버를 볼 수 있다.
- 사원은 개인, 그룹메시지 목록의 채팅방 중 하나를 선택해서 채팅을 할 수 있다.
- 사원은 사원 검색에서 사원을 검색한다.
- 검색한 사원을 초대 멤버에 추가한다.
- 추가한 멤버들과 채팅방을 만든다.
- 채팅방 안에서 채팅을 할 수 있다.
- 사원은 채팅 중 방상세정보로 들어가서 방상세정보를 확인할 수 있고, 채팅방 관리를 할 수 있다.


**엔티티**

- 사원프로필 : 사원사진, 이름, 온오프상태, 소속부서, 직급
- 개인메시지목록 : 채팅상대정보(사원사진,이름,소속부서,직급,온오프상태),새로온메시지갯수
- 그룹메시지목록 : 채팅그룹정보(채팅방명)와 새로온메시지갯수
- 직원목록 : 사원사진, 사원이름, 소속부서, 사원직급, 선택상태,
- 초대목록 : 선택된(사원사진, 사원이름, 소속부서, 직급, 삭제상태(?)
- 대화방_개인 : 채팅상대이름, 채팅작성시간, 받은채팅내용, 보내는채팅내용,
                 채팅상태정보(어디까지읽었는지,대화날짜), 링크, 파일, 방상세정보
- 대화방_그룹 : 채팅방명, 채팅방설명, 받은채팅내용, 보내는채팅내용, 채팅인원,
                 채팅상태정보(어디까지읽었는지, 대화날짜), 링크, 파일, 방상세정보
- 방상세정보 : 대화상대목록(사진,이름,소속부서,직급), 대화상대초대,
               사진 및 동영상(사진갯수,사진/동영상 용량, 올린날짜)
               /파일(파일갯수,파일용량,올린날짜)/링크 관리(목록,공유,삭제 기능)




### 3. ERD 만들기

ERD 툴은 [ERDcloud](https://www.erdcloud.com/)를 이용했다.

요구사항 분석을 참고하여 엔티티들을 테이블로 만들고 `1:1`, `1:n`, `n:m`으로 관계를 생성해준다.
관계를 생성할 때 한쪽 테이블의 외래키가 다른쪽 테이블의 기본키가 되는경우 **식별관계**, 일반 칼럼이 되는경우 비 **식별관계**로 설정한다.

`장바구니` - `상품`의 경우 n:m의 관계이기 때문에 `장바구니_상품`이라는 관계테이블을 생성하였는데

![img](https://media.vlpt.us/images/doryyy/post/ba206140-d006-4c36-9ea1-89eda01ab394/Untitled%20(6).png)

이렇게 만들경우 백엔드로 구현할때 조인이 많아져 쿼리문이 복잡해져서 구현이 힘들어지므로 `장바구니_상품` 테이블에 장바구니의 칼럼들을 추가해주고(역정규화) 장바구니 테이블을 삭제 해준다

![img](https://media.vlpt.us/images/doryyy/post/e8d9b31a-983a-4ec5-923b-880f5f1af742/Untitled%20(7).png)

그럼 위와 같이 ERD가 완성된다.